## Beam Search 光束搜索

光束搜索用于解决一类问题：预测序列的时候每步只能预测一个元素，我们期望预测出整个序列的概率是所有元素的联合条件概率。如果每步预测都预测当前概率最大的元素，最后的序列却可能不是概率最大的序列。

以神经机器翻译的解码问题为例。光束搜索中，一共有$b$个路径，$b$也叫光束宽度。路径是一个序列的已经生成的词。
<br>
一开始，选择$b$个概率最大的词作为$b$个最优路径的第一个词。
<br>
然后，每个最优路径对词表中的每个词扩展一步，产生$n\_vocab$个候选路径，那么一共有$b \times n\_vocab$个候选路径。选择前$b$个对数概率和最大的路径最为新的$b$个最优路径。
<br>
重复上一步，直到所有的路径都遇到句尾$<eos>$字符，结束迭代。这$b$个路径就是$b$个最佳译文。


<img src="https://nlppupil.github.io/images/beam.png" alt="BP" style="width:200px;height:380px;">


光束搜索也是一种贪婪搜索，相比于普通贪婪搜索每次只选择当前最好的一个选项，光束搜索只不过选的是当前最好的多个选项。也就是说，光束搜索依然无法保证能找到概率最大的预测序列。示意图呈光束状向前发散，所以叫光束搜索。有的资料翻译成柱搜索，容易引起困惑。


**参考资料**
Neural Machine Translation and Sequence-to-sequence Models: A Tutorial
