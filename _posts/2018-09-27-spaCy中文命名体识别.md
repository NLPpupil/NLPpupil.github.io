---
layout: post
title:  "spaCy中英文命名体识别"
date:   2018-09-22
categories: 自然语言处理 深度学习 命名体识别
---



#### spaCy简介和安装
[spaCy](https://spacy.io/)是一个自然语言处理工具，可以用来词性标注、依存句法分析、命名体识别、tokenize、分句和规则匹配。spaCy支持自己用标记的数据训练自定义模型，这样就可以训练自定义类别的命名体识别分类器。

安装很简单：

```
pip install -U spacy
```

下一步是安装模型，对于英文：

`python -m spacy download en_core_web_lg`

但是模型太大，总是下载失败，需要手动下载。
用浏览器打开`https://github.com/explosion/spacy-models/releases/download/en_core_web_lg-2.0.0/en_core_web_lg-2.0.0.tar.gz`。
模型下载好后，解压，随便放在一个目录下，比如`Downloads/`，然后
`python -m spacy link ~/Downloads/en_core_web_lg-2.0.0/en_core_web_lg en_core_web_lg`
如果出现

![实验结果树状图](https://raw.githubusercontent.com/NLPpupil/markdown-images/master/spacy.png)

表示安装成功。

#### spaCy命名体识别
spaCy的命名体识别采用[transition-based模型](https://nlppupil.github.io/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/2018/09/22/Transition-based%E5%91%BD%E5%90%8D%E4%BD%93%E8%AF%86%E5%88%AB.html)。命名体识别用法见[Named Entities](https://spacy.io/usage/linguistic-features#section-named-entities)。一个简单的脚本见[spacyner.py](https://github.com/NLPpupil/spaCy_NER/blob/master/spacyner.py)

spaCy暂时没有中文完整模型，中文只支持内嵌结巴的分词。[Training the named entity recognizer](https://spacy.io/usage/training#section-ner) 说明了如何用自己标记的数据更新已有模型和训练新的模型。
训练数据形如

```
# training data
TRAIN_DATA = [
    ('Who is Shaka Khan?', {
        'entities': [(7, 17, 'PERSON')]
    }),
    ('I like London and Berlin.', {
        'entities': [(7, 13, 'LOC'), (18, 24, 'LOC')]
    })
]
```
[annotate\_ner.py](https://github.com/NLPpupil/spaCy_NER/blob/master/annotate_ner.py) 用来辅助标记训练数据，用法见脚本注释。然后运行官方例子稍作修改的[zh\_trainer\_ner.py](https://github.com/NLPpupil/spaCy_NER/blob/master/zh_trainer_ner.py)。

训练完成后，在运行识别程序的时候，把模型改成训练的模型，整个自定义中文命名体识别器就做好了。

